**EXPLAIN**


Excellent ğŸ‘ This is a very important interview and practical DB concept.

Now I will explain EXPLAIN command in detail, including:

What it does

Why it is used

How it works internally

Execution plan components

Real examples (MySQL & PostgreSQL style)

How to optimize queries using EXPLAIN

ğŸ“˜ What is EXPLAIN in Database?

EXPLAIN is a SQL command used to:

Show how the DBMS will execute a query.

It does NOT execute the query.
It only shows the execution plan.

ğŸ”¹ Why is EXPLAIN Important?

Because:

SQL queries may work correctly

But can be slow

Or may scan entire table unnecessarily

EXPLAIN helps in:

âœ” Performance tuning
âœ” Checking index usage
âœ” Understanding joins
âœ” Finding full table scans
âœ” Optimizing queries

ğŸ“˜ Basic Syntax
EXPLAIN SELECT * FROM table_name WHERE condition;
ğŸ“˜ Simple Example
ğŸ”¹ Table: employees
id	name	salary
1	Ram	30000
2	Sam	50000
3	Ravi	70000
ğŸ”¸ Query:
SELECT * FROM employees WHERE salary = 50000;

Now we use:

EXPLAIN SELECT * FROM employees WHERE salary = 50000;
ğŸ“˜ Example Output (MySQL Style)
id	select_type	table	type	possible_keys	key	rows	Extra
1	SIMPLE	employees	ALL	NULL	NULL	1000	Using where
ğŸ“˜ Explanation of Each Column
ğŸ”¹ 1ï¸âƒ£ select_type

Tells type of query:

SIMPLE â†’ Normal query

PRIMARY â†’ Main query

SUBQUERY â†’ Nested query

ğŸ”¹ 2ï¸âƒ£ table

Which table is being accessed.

ğŸ”¹ 3ï¸âƒ£ type (Very Important)

Shows how rows are accessed.

This tells performance quality.

Type	Meaning	Performance
system	Best possible	Fastest
const	Single row match	Very Fast
eq_ref	Unique index lookup	Very Good
ref	Index lookup	Good
range	Index range scan	Good
index	Full index scan	Medium
ALL	Full table scan	âŒ Slow

In our example:

ALL â†’ Full table scan â†’ Bad performance.

ğŸ”¹ 4ï¸âƒ£ possible_keys

Indexes that could be used.

ğŸ”¹ 5ï¸âƒ£ key

Actual index used.

NULL means:

âŒ No index used.

ğŸ”¹ 6ï¸âƒ£ rows

Estimated number of rows scanned.

If large number:

Bad performance.

ğŸ”¹ 7ï¸âƒ£ Extra

Additional information.

Examples:

Using where

Using index

Using temporary

Using filesort
-------------------------------------------------------------------------------------
1ï¸âƒ£ How do you rate yourself in databases?
âœ… How to Answer in CGG Interview

This question checks:

Your confidence

Your honesty

Your practical exposure

Your understanding depth

ğŸ¯ Ideal Structured Answer

â€œI would rate myself around 8/10 in databases. I am comfortable with writing complex SQL queries, joins, subqueries, indexing, normalization, views, stored procedures, and basic performance tuning. I have worked with relational databases like MySQL/PostgreSQL. I am currently improving in advanced performance optimization and execution plan analysis.â€

ğŸ” What They Expect at CGG

Since CGG works with:

Government data

Citizen records

Large scale systems

Secure databases

They want you to know:

Data consistency

Constraints

Indexing

Performance tuning

Security

Transactions (ACID properties)

ğŸ’¡ If they ask â€œWhy not 10?â€

You say:

â€œBecause I believe database optimization and query tuning at enterprise scale requires continuous learning.â€

That shows maturity.


------------------------------------------------------------------------------
offset vs limit
In SQL, the key difference is that the LIMIT clause restricts the maximum number of rows returned by a query, while the OFFSET clause specifies the number of rows to skip from the beginning of the result set



Feature 	LIMIT	OFFSET
Purpose	Specifies how many records to return.	Specifies where to start returning records (the starting point) by skipping rows.
Function	Caps the total number of results in the output.	Excludes a specified number of initial rows from the results.
Usage	Often used alone or with OFFSET.	Typically used in conjunction with LIMIT or FETCH for pagination.
Effect on data	Determines the size of the final result set.	Determines which "page" of data is retrieved.
-------------------------------------------------------

â“ 2ï¸âƒ£ How Do You Fetch Large Data Faster?
ğŸš¨ Real Scenario

Table: citizens
Records: 50 million

Bad Query:

SELECT * FROM citizens;
âŒ Why is this bad?

Full table scan

High disk I/O

High memory usage

Large network transfer

Blocks system for others

In government systems with:

Aadhaar

Voter DB

Land records

This is unacceptable.

ğŸ” What Actually Makes Queries Slow?

When DB executes query:

Parses SQL

Checks metadata

Finds execution plan

Accesses disk

Loads rows into memory

Sends result over network

For 50M rows:

Disk read becomes major bottleneck

Network transfer huge

Memory pressure increases

So optimization must reduce:

ğŸ‘‰ Disk reads
ğŸ‘‰ Rows scanned
ğŸ‘‰ Data transferred
ğŸ‘‰ CPU load

âœ… 1ï¸âƒ£ Use Proper Indexing (Most Important)
ğŸ”¹ Without Index

DB must scan every row:

Full Table Scan â†’ O(n)

For 50M rows â†’ extremely slow

ğŸ”¹ With Index

Index is usually:

B-Tree structure

Balanced tree

O(log n)

CREATE INDEX idx_aadhar ON citizens(aadhar_no);

Now:

SELECT * FROM citizens WHERE aadhar_no = '123456789012';

DB uses index â†’ Direct pointer to row

Very fast ğŸ”¥

ğŸ”¹ Types of Indexing

Single column index

Composite index

Covering index

Clustered index

Non-clustered index

ğŸ”¹ Covering Index (Advanced)

Instead of:

SELECT name, district FROM citizens WHERE aadhar_no='123';

Create:

CREATE INDEX idx_cover ON citizens(aadhar_no, name, district);

Now query can be satisfied using only index â€”
No table access needed.

Even faster ğŸš€

âœ… 2ï¸âƒ£ Avoid SELECT *
ğŸ”¹ Why It's Bad?
SELECT * FROM citizens;

Loads all columns

Loads unnecessary data

More memory usage

More network time

Instead:

SELECT name, district FROM citizens;

Advantages:

âœ” Less data transfer
âœ” Less CPU
âœ” Less RAM
âœ” Faster response

This is critical for APIs.

âœ… 3ï¸âƒ£ Always Use WHERE Clause

Never fetch entire production table.

Bad:

SELECT * FROM citizens;

Good:

SELECT * FROM citizens WHERE district='Hyderabad';

Even better with index:

CREATE INDEX idx_district ON citizens(district);
âœ… 4ï¸âƒ£ Use Pagination (LIMIT / OFFSET)

Large data must be paginated.

SELECT * FROM citizens LIMIT 100;

API Example:

Page 1:

SELECT * FROM citizens LIMIT 0,50;

Page 2:

SELECT * FROM citizens LIMIT 50,50;
ğŸ”¹ Better Pagination (Keyset Pagination)

Instead of OFFSET (slow for large offsets), use:

SELECT * FROM citizens
WHERE id > 50000
LIMIT 50;

Faster for huge datasets.

âœ… 5ï¸âƒ£ Use Table Partitioning

When table becomes massive:

Split into partitions.

Example:

Partition by state:

citizens_AP

citizens_TS

citizens_KA

Or range partition:

PARTITION BY RANGE (year_of_registration)

Advantages:

âœ” Queries scan only relevant partition
âœ” Faster execution
âœ” Better maintenance

âœ… 6ï¸âƒ£ Optimize Joins

Bad:

SELECT * FROM citizens c, payments p;

This is cross join â†’ huge explosion of rows.

Correct:

SELECT c.name, p.amount
FROM citizens c
JOIN payments p
ON c.id = p.citizen_id;

Also ensure:

Index on join columns

Avoid unnecessary joins

Use proper join order

âœ… 7ï¸âƒ£ Use EXPLAIN

Always check execution plan:

EXPLAIN SELECT * FROM citizens WHERE district='Hyderabad';

Check:

type (ALL â†’ bad)

key (index used?)

rows (how many scanned?)

Extra (using filesort?)

âœ… 8ï¸âƒ£ Caching (Real Production Level)

For frequently accessed data:

Use Redis

Use Memcached

Use application-level caching

Example:

Citizen profile accessed often â†’ Cache it.

Reduces DB load drastically.

âœ… 9ï¸âƒ£ Use Read Replicas

In large government systems:

Master DB handles writes

Replica DB handles reads

This improves read performance.

âœ… ğŸ”Ÿ Use Proper Database Configuration

Tune:

Buffer pool size

Query cache

Index memory

Connection pool

ğŸ¯ Interview Summary (Perfect Answer)

To fetch large data faster in large government databases, I use proper indexing (especially on frequently filtered columns), avoid SELECT *, apply WHERE clauses, implement pagination, analyze execution plans using EXPLAIN, optimize joins, and use partitioning when necessary. In production systems, I also use caching and read replicas to improve scalability and reduce load.

---------------------------------------------------------------------------

3ï¸âƒ£ How do you debug SQL queries?

Very important practical question.

ğŸ” Step-by-Step Debugging Approach
1ï¸âƒ£ Check Syntax Errors

Example:

SELEC * FROM employees;

Correct:

SELECT * FROM employees;
2ï¸âƒ£ Break Complex Query into Parts

If query:

SELECT * 
FROM employees e
JOIN department d ON e.dept_id = d.id
WHERE salary > (SELECT AVG(salary) FROM employees);

Debug in steps:

Test subquery first

Test join separately

Combine

3ï¸âƒ£ Use EXPLAIN
EXPLAIN SELECT * FROM employees WHERE salary > 50000;

Check:

Table scan?

Index usage?

4ï¸âƒ£ Check NULL Issues

Many bugs happen because of NULL.

Wrong:

WHERE salary = NULL

Correct:

WHERE salary IS NULL
5ï¸âƒ£ Check Join Conditions

Missing ON condition causes Cartesian Product.

Bad:

SELECT * FROM employees, department;

Returns millions of rows.

6ï¸âƒ£ Verify Data Types

If column is INT and you compare string â†’ performance issue.

ğŸ¯ Interview Answer

I debug SQL queries by checking syntax, testing parts separately, verifying joins and NULL conditions, using EXPLAIN to analyze execution plans, and validating indexes.

-------------------------------------------------------------------------------------------

4ï¸âƒ£ What do you mean by Views?
ğŸ“Œ Definition

A view is a virtual table created from a query.

It does not store data physically (normal view).

ğŸ¯ Why Views?

Security

Simplify complex queries

Reusability

Hide sensitive columns

ğŸ“Œ Example

Employees table:

| id | name | salary | password |

Create secure view:

CREATE VIEW emp_public AS
SELECT id, name FROM employees;

Now:

SELECT * FROM emp_public;

Password hidden ğŸ”

ğŸ” Types of Views

1ï¸âƒ£ Simple View
2ï¸âƒ£ Complex View
3ï¸âƒ£ Materialized View (stores data physically)

ğŸ”¥ CGG Use Case

Government portal:

Admin sees full data

Citizen sees limited data

Views help enforce that.

ğŸ¯ Interview Summary

A view is a virtual table derived from a query used for security, abstraction, and simplification.

---------------------------------------------------------------------------------------------------

5ï¸âƒ£ What is an API?
ğŸ“Œ Definition

API (Application Programming Interface) is a bridge that allows two applications to communicate.

ğŸ” Real Flow in CGG System

Citizen Portal (Frontend)
â¬‡
Backend API
â¬‡
Database

ğŸ“¦ Example

When citizen checks application status:

Frontend calls:

GET /api/application/123

Backend:

SELECT * FROM applications WHERE id = 123;

Returns JSON:

{
  "id": 123,
  "status": "Approved"
}
ğŸ” Types of APIs

1ï¸âƒ£ REST API
2ï¸âƒ£ SOAP API
3ï¸âƒ£ GraphQL

Most used: REST

ğŸ“Œ HTTP Methods

GET â†’ Fetch
POST â†’ Insert
PUT â†’ Update
DELETE â†’ Delete

ğŸ¯ Why Important for CGG?

Because:

Government portals

Mobile apps

Multiple departments

Data sharing between systems

APIs connect all systems.

------------------------------------------------------------------------------

6ï¸âƒ£ What are Functions and Triggers?
ğŸ”¹ A) What are Functions?
ğŸ“Œ Definition

A Function is a reusable block of SQL statements that:

Takes input parameters

Performs logic

Returns a single value

ğŸ§  Why Needed?

To avoid rewriting logic again and again.

âœ… Example â€“ Salary Bonus Calculation
CREATE FUNCTION calculate_bonus(salary DECIMAL(10,2))
RETURNS DECIMAL(10,2)
DETERMINISTIC
BEGIN
   RETURN salary * 0.10;
END;

Usage:

SELECT name, calculate_bonus(salary) AS bonus
FROM employees;
ğŸ¯ Real-Time CGG Example

Suppose:

Pension calculation

Tax calculation

Scholarship eligibility amount

Instead of writing formula everywhere â†’ create function.

ğŸ”¹ B) What are Triggers?
ğŸ“Œ Definition

A Trigger is a database object that automatically executes when:

INSERT

UPDATE

DELETE happens on a table.

ğŸ”„ Types:

BEFORE INSERT

AFTER INSERT

BEFORE UPDATE

AFTER UPDATE

BEFORE DELETE

AFTER DELETE

âœ… Example â€“ Audit Log
CREATE TRIGGER before_employee_insert
BEFORE INSERT ON employees
FOR EACH ROW
SET NEW.created_at = NOW();
ğŸ¯ Real-Time CGG Use Case

Government system needs:

Who modified land records?

Who updated citizen data?

Who deleted tax details?

Trigger example:

CREATE TRIGGER log_update
AFTER UPDATE ON citizens
FOR EACH ROW
INSERT INTO audit_log(user_id, action_time)
VALUES (CURRENT_USER(), NOW());
ğŸ† Interview Summary

Functions return values and are reusable logic blocks.
Triggers execute automatically in response to table events and are mainly used for auditing and validation.

--------------------------------------------------------------------------------------

7ï¸âƒ£ Write an example for UPDATE query?
ğŸ“Œ Definition

UPDATE modifies existing records.

Basic Example
UPDATE employees
SET salary = 60000
WHERE emp_id = 101;
ğŸ” Update Multiple Columns
UPDATE employees
SET salary = 70000,
    department_id = 3
WHERE emp_id = 102;
âš  Important

If you donâ€™t write WHERE:

UPDATE employees
SET salary = 50000;

ğŸ‘‰ Updates ALL rows âŒ Dangerous

ğŸ¯ CGG Real Example

Update application status:

UPDATE applications
SET status = 'Approved'
WHERE application_id = 2001;
ğŸ† Interview Tip

Mention:

Always use WHERE

Wrap UPDATE inside transaction in production

---------------------------------------------------------------------
8ï¸âƒ£ Difference Between TRUNCATE, DELETE and DROP
ğŸ”¹ 1) DELETE

Removes specific rows.

DELETE FROM employees
WHERE department_id = 5;

âœ” Can use WHERE
âœ” Can rollback
âœ” Slower than truncate

ğŸ”¹ 2) TRUNCATE

Removes ALL rows quickly.

TRUNCATE TABLE employees;

âœ” Fast
âŒ No WHERE
âŒ Usually cannot rollback
âœ” Resets auto-increment

ğŸ”¹ 3) DROP

Removes entire table including structure.

DROP TABLE employees;

âœ” Deletes structure + data
âŒ Cannot rollback
âŒ Table gone completely

ğŸ§  Comparison Table
Feature	DELETE	TRUNCATE	DROP
Remove specific rows	âœ…	âŒ	âŒ
WHERE clause	âœ…	âŒ	âŒ
Remove table structure	âŒ	âŒ	âœ…
Rollback	âœ…	âŒ	âŒ
Speed	Slow	Fast	Fast
ğŸ¯ CGG Real Case

DELETE â†’ Remove inactive users

TRUNCATE â†’ Clear temporary report table

DROP â†’ Remove old unused table

---------------------------------------------------

9ï¸âƒ£ SQL Query to Find Second Maximum Value

Assume table:

employees(id, name, salary)

âœ… Method 1: Using Subquery
SELECT MAX(salary) 
FROM employees
WHERE salary < (SELECT MAX(salary) FROM employees);

âœ” Most common interview answer

âœ… Method 2: Using LIMIT
SELECT salary
FROM employees
ORDER BY salary DESC
LIMIT 1 OFFSET 1;
âœ… Method 3: Using DISTINCT
SELECT DISTINCT salary
FROM employees
ORDER BY salary DESC
LIMIT 1 OFFSET 1;

Important when duplicates exist.

ğŸ¯ CGG Real Use

Second highest taxpayer

Second highest pension

Second highest district revenue

-----------------------------------------------------------------

ğŸ“˜ Types of Joins in SQL (Detailed Explanation)
ğŸ—‚ Assume Two Tables
ğŸ”¹ employees
id	name	dept_id
1	Ram	10
2	Sam	20
3	Ravi	30
4	Kiran	NULL
ğŸ”¹ departments
dept_id	dept_name
10	HR
20	IT
40	Finance

Now letâ€™s understand each JOIN type.

ğŸ”¹ 1ï¸âƒ£ INNER JOIN
âœ… Definition

Returns only the rows where there is a match in both tables.

SQL:
SELECT e.name, d.dept_name
FROM employees e
INNER JOIN departments d
ON e.dept_id = d.dept_id;
ğŸ”¹ Output:
name	dept_name
Ram	HR
Sam	IT
ğŸ” Explanation

Ravi (dept_id 30) â†’ No matching department â†’ Excluded

Kiran (dept_id NULL) â†’ No match â†’ Excluded

Finance department (40) â†’ No employee â†’ Excluded

âœ” Only matched records.

ğŸ“Œ When to Use?

When you want only valid matches.

Most common join.

Used in report generation.

ğŸ”¹ 2ï¸âƒ£ LEFT JOIN (LEFT OUTER JOIN)
âœ… Definition

Returns:

All rows from left table

Matching rows from right

NULL if no match

SQL:
SELECT e.name, d.dept_name
FROM employees e
LEFT JOIN departments d
ON e.dept_id = d.dept_id;
ğŸ”¹ Output:
name	dept_name
Ram	HR
Sam	IT
Ravi	NULL
Kiran	NULL
ğŸ” Explanation

Ravi â†’ dept_id 30 not found â†’ dept_name NULL

Kiran â†’ dept_id NULL â†’ dept_name NULL

âœ” All employees shown.

ğŸ“Œ When to Use?

Show all employees

Even if they don't belong to a department

Common in audit reports

ğŸ”¹ 3ï¸âƒ£ RIGHT JOIN (RIGHT OUTER JOIN)
âœ… Definition

Returns:

All rows from right table

Matching rows from left

NULL if no match

SQL:
SELECT e.name, d.dept_name
FROM employees e
RIGHT JOIN departments d
ON e.dept_id = d.dept_id;
ğŸ”¹ Output:
name	dept_name
Ram	HR
Sam	IT
NULL	Finance
ğŸ” Explanation

Finance department has no employee â†’ name NULL

âœ” All departments shown.

ğŸ“Œ When to Use?

When department list is primary

Show departments even if empty

ğŸ”¹ 4ï¸âƒ£ FULL JOIN (FULL OUTER JOIN)
âœ… Definition

Returns:

All rows from both tables

NULL where no match

SQL:
SELECT e.name, d.dept_name
FROM employees e
FULL JOIN departments d
ON e.dept_id = d.dept_id;
ğŸ”¹ Output:
name	dept_name
Ram	HR
Sam	IT
Ravi	NULL
Kiran	NULL
NULL	Finance
ğŸ” Explanation

Combines LEFT + RIGHT join.

âœ” All employees
âœ” All departments

âš  Note:
MySQL doesnâ€™t support FULL JOIN directly.
You simulate using UNION.

ğŸ”¹ 5ï¸âƒ£ CROSS JOIN
âœ… Definition

Returns Cartesian Product.

Each row from first table Ã— each row from second table.

SQL:
SELECT *
FROM employees
CROSS JOIN departments;
ğŸ”¹ Output Size

Employees = 4
Departments = 3

Total rows:

4 Ã— 3 = 12 rows

âš  Dangerous if large tables.

If:

citizens = 50 million
lands = 10 million

Result:

500 trillion rows ğŸ˜± (system crash)

ğŸ”¹ 6ï¸âƒ£ SELF JOIN (Bonus â€“ Often Asked)

When a table joins itself.

Example:

SELECT e.name, m.name AS manager
FROM employees e
JOIN employees m
ON e.manager_id = m.id;

Used in:

Hierarchy

Reporting structure


-----------------------------------------------------------------------

1ï¸âƒ£1ï¸âƒ£ What is a Self Join? Explain with Example.
ğŸ“Œ Definition

A Self Join is when a table is joined with itself.

It is used when:

A table has hierarchical data

A row depends on another row in the same table

ğŸ§  Example Scenario

Table: employees

emp_id	name	manager_id
1	Ravi	NULL
2	Arun	1
3	Sita	1
4	Kiran	2

Here:

Arun reports to Ravi

Kiran reports to Arun

âœ… Self Join Query
SELECT e.name AS Employee,
       m.name AS Manager
FROM employees e
JOIN employees m
ON e.manager_id = m.emp_id;
ğŸ” How It Works

employees e â†’ employee table alias 1

employees m â†’ same table alias 2

Join using manager_id

ğŸ¯ CGG Real-Time Use Case

Government hierarchy:

District Collector

Mandal Officer

Village Officer

Or:

Land records:

Parent property

Sub-division property

Self-join helps show reporting structure.

----------------------------------------------------------------------

1ï¸âƒ£2ï¸âƒ£ Difference Between IN and ANY Operator
ğŸ”¹ IN Operator

Checks if a value matches any value in a list or subquery result.

Example:
SELECT * 
FROM employees
WHERE dept_id IN (10, 20, 30);
Using Subquery:
SELECT * 
FROM employees
WHERE dept_id IN (SELECT dept_id FROM departments);

âœ” Equivalent to multiple OR conditions.

ğŸ”¹ ANY Operator

Compares a value with any value returned by a subquery using a comparison operator.

Example:
SELECT *
FROM employees
WHERE salary > ANY (SELECT salary FROM managers);

Meaning:

Employee salary > at least one manager salary

ğŸ” Difference Table
IN	ANY
Compares equality	Works with >, <, >=, <=
Simpler	More flexible
Equivalent to multiple OR	Compares with subquery values
ğŸ¯ CGG Example

IN:

Get applications from certain districts

ANY:

Find officer with salary higher than any regional head

----------------------------------------------------------------------------------------------

13ï¸âƒ£ What are Set Operators?
ğŸ“Œ Definition

Set operators combine results of two SELECT statements.

ğŸ”¹ Types

1ï¸âƒ£ UNION
2ï¸âƒ£ UNION ALL
3ï¸âƒ£ INTERSECT
4ï¸âƒ£ EXCEPT / MINUS

ğŸ”¹ Example Tables

district1
district2

âœ… UNION
SELECT name FROM district1
UNION
SELECT name FROM district2;

Removes duplicates.

âœ… UNION ALL
SELECT name FROM district1
UNION ALL
SELECT name FROM district2;

Keeps duplicates.

âœ… INTERSECT
SELECT name FROM district1
INTERSECT
SELECT name FROM district2;

Common records only.

âœ… EXCEPT
SELECT name FROM district1
EXCEPT
SELECT name FROM district2;

Records in district1 but not in district2.

ğŸ¯ CGG Use Case

Combine citizen data from two departments

Find common beneficiaries

Find unmatched records between systems

-----------------------------------------------------------------------------------------------
1ï¸âƒ£4ï¸âƒ£ Difference Between UNION and UNION ALL
ğŸ”¹ UNION

Removes duplicates

Slower (because it sorts internally)

ğŸ”¹ UNION ALL

Keeps duplicates

Faster

No sorting required

ğŸ” Example

district A:
Ravi, Sita

district B:
Ravi, Arun

UNION Result:

Ravi, Sita, Arun

UNION ALL Result:

Ravi, Sita, Ravi, Arun

ğŸ† Performance Note (Important for CGG)

Large government database:

If duplicate removal is not required â†’ use UNION ALL
Because UNION causes sorting + extra memory usage.

--------------------------------------------------------------------------------------------

1ï¸âƒ£5ï¸âƒ£ How Does Natural Join Work?
ğŸ“Œ Definition

Natural Join automatically joins two tables based on columns with the same name.

You do not specify ON condition.

ğŸ§  Example Tables

employees

| emp_id | name | dept_id |

departments

| dept_id | dept_name |

âœ… Natural Join
SELECT *
FROM employees
NATURAL JOIN departments;

Automatically joins on dept_id.

ğŸ” How It Works

Database finds same column name

Applies equality join on them

Equivalent to:

SELECT *
FROM employees
JOIN departments
ON employees.dept_id = departments.dept_id;
âš  Why Not Recommended in Production?

If column name changes â†’ Query breaks

If multiple same column names â†’ Unexpected results

Not explicit â†’ Hard to debug

ğŸ¯ CGG Real Example

If two tables:

citizens (district_id)
districts (district_id)

Natural join will automatically join on district_id.

But in real government systems â†’ explicit JOIN is preferred.

â­ Important CGG Interview Tip

For every join-related answer mention:

INNER JOIN â†’ Only matching

LEFT JOIN â†’ Keep all left

RIGHT JOIN â†’ Keep all right

FULL JOIN â†’ Keep all

Self Join â†’ Hierarchy

Natural Join â†’ Automatic join based on column name

And always mention:

â€œIn production systems like CGG, explicit joins are preferred for better clarity and maintenance.â€

--------------------------------------------------------------------------

1ï¸âƒ£6ï¸âƒ£ What are Functions in SQL?
ğŸ“Œ Definition

A Function in SQL is a reusable program block that:

Accepts input parameters

Performs some logic

Returns a single value

It improves:

Reusability

Maintainability

Clean code

ğŸ”¹ Types of Functions
1ï¸âƒ£ Built-in Functions

COUNT()

SUM()

AVG()

MAX()

MIN()

NOW()

UPPER()

LOWER()

Example:

SELECT COUNT(*) FROM citizens;
2ï¸âƒ£ User Defined Function (UDF)

You create custom logic.

âœ… Example â€“ Tax Calculation
CREATE FUNCTION calculate_tax(income DECIMAL(10,2))
RETURNS DECIMAL(10,2)
DETERMINISTIC
BEGIN
   RETURN income * 0.15;
END;

Use it:

SELECT name, calculate_tax(salary) AS tax
FROM employees;
ğŸ¯ CGG Real-Time Example

In government systems:

Pension calculation

Property tax calculation

Scholarship amount calculation

Utility bill calculation

Instead of rewriting formula â†’ use function.

ğŸ† Interview Summary

SQL functions are reusable logic blocks that return a single value and improve modularity in database programming.

-----------------------------------------------------------------------------------

ğŸ”· What are Procedures in SQL?
ğŸ“Œ Definition

A Stored Procedure is:

A precompiled collection of SQL statements stored inside the database that can be executed as a single unit.

It allows us to group multiple SQL statements together and reuse them.

ğŸ”· Why Are They Called "Stored"?

Because:

They are saved inside the database server.

Not written in application code.

They remain there until dropped.

ğŸ”· Characteristics of Stored Procedures

A Stored Procedure:

âœ” Can accept input parameters
âœ” May return output values
âœ” Can contain multiple SQL statements
âœ” Can include conditional logic (IF, CASE)
âœ” Can include loops (WHILE)
âœ” Can modify data (INSERT, UPDATE, DELETE)
âœ” Can call other procedures

ğŸ”· Basic Example
ğŸ“Œ Simple Procedure
CREATE PROCEDURE get_employee_details(IN empId INT)
BEGIN
   SELECT * FROM employees 
   WHERE emp_id = empId;
END;
ğŸ”¹ Calling the Procedure
CALL get_employee_details(101);
ğŸ” How It Works

empId is an input parameter.

The procedure fetches employee details.

Instead of writing query repeatedly, we call procedure.

ğŸ”· Complex Example
CREATE PROCEDURE update_salary(
    IN empId INT,
    IN newSalary DECIMAL(10,2)
)
BEGIN
   UPDATE employees
   SET salary = newSalary
   WHERE emp_id = empId;
END;
ğŸ”¹ Execution
CALL update_salary(101, 60000);

This updates salary for employee 101.

ğŸ”· Types of Parameters

Stored procedures support:

ğŸ”¹ 1ï¸âƒ£ IN (Input)

Used to pass values into procedure.

Example:

IN empId INT
ğŸ”¹ 2ï¸âƒ£ OUT (Output)

Used to return value.

Example:

CREATE PROCEDURE get_total(IN deptId INT, OUT total INT)
BEGIN
   SELECT COUNT(*) INTO total 
   FROM employees 
   WHERE dept_id = deptId;
END;

Calling:

CALL get_total(10, @count);
SELECT @count;
ğŸ”¹ 3ï¸âƒ£ INOUT

Used for both input and output.

ğŸ”· Real CGG Government Portal Example

Suppose a citizen applies for income certificate.

Inside one stored procedure, system may:

1ï¸âƒ£ Insert application into applications table
2ï¸âƒ£ Update status table
3ï¸âƒ£ Insert entry in audit_log
4ï¸âƒ£ Generate application number
5ï¸âƒ£ Insert notification entry

Example:

CREATE PROCEDURE apply_certificate(
   IN citizenId INT,
   IN certType VARCHAR(50)
)
BEGIN
   INSERT INTO applications(citizen_id, certificate_type)
   VALUES(citizenId, certType);

   UPDATE citizens 
   SET last_applied = NOW()
   WHERE id = citizenId;

   INSERT INTO logs(action)
   VALUES('Certificate Applied');
END;

Everything happens in one call.

ğŸ”· Advantages of Stored Procedures
1ï¸âƒ£ Security

Users can be given permission to execute procedure only.

They cannot directly access tables.

Example:

GRANT EXECUTE ON PROCEDURE get_employee_details TO user1;

This improves data security.

2ï¸âƒ£ Faster Execution

Because:

Stored procedures are precompiled.

Execution plan is stored.

Less parsing each time.

3ï¸âƒ£ Centralized Business Logic

All business logic stored in database.

Application becomes thinner.

Better maintainability.

4ï¸âƒ£ Reduced Network Traffic

Instead of sending multiple queries from application:

One procedure call handles everything.

5ï¸âƒ£ Transaction Control

Procedure can control:

START TRANSACTION;
COMMIT;
ROLLBACK;

Ensures consistency.

ğŸ”· Stored Procedure vs Function
Feature	Stored Procedure	Function
Returns value	Optional	Must return value
Used in SELECT	No	Yes
Can modify data	Yes	Limited
Used for	Business logic	Calculations
ğŸ”· Internal Working

When procedure is created:

1ï¸âƒ£ SQL is parsed
2ï¸âƒ£ Execution plan generated
3ï¸âƒ£ Stored in system catalog
4ï¸âƒ£ On call â†’ executed directly

ğŸ”· When To Use Procedures

âœ” Complex transaction logic
âœ” Financial operations
âœ” Government record updates
âœ” Report generation
âœ” Reusable operations

ğŸ”· When Not To Use

âŒ When business logic frequently changes
âŒ When database portability required
âŒ When application-level logic preferred

ğŸ¯ Interview Ready Answer

A Stored Procedure is a precompiled set of SQL statements stored in the database that can accept parameters, perform complex operations, and optionally return values. It is mainly used for centralized business logic, improved performance, security, and reducing network traffic.

------------------------------------------------------------------------------------
1ï¸âƒ£9ï¸âƒ£ Difference Between Primary Key and Composite Key
ğŸ”¹ Primary Key

Uniquely identifies each row

Cannot be NULL

Only one primary key per table

Can be single column

Example:

CREATE TABLE students (
    student_id INT PRIMARY KEY,
    name VARCHAR(100)
);
ğŸ”¹ Composite Key

Primary key made of multiple columns.

Used when:
Single column is not enough to uniquely identify row.

Example

Enrollment table:

CREATE TABLE enrollments (
   student_id INT,
   course_id INT,
   PRIMARY KEY(student_id, course_id)
);

Why?

Because:

One student can join many courses

One course can have many students

But same student cannot join same course twice

ğŸ¯ CGG Real Example

Property records:

Composite key:
(property_id, survey_number)

Or:

Government scheme:
(citizen_id, scheme_id)

ğŸ† Interview Summary

Primary key uniquely identifies a record.
Composite key is a combination of multiple columns used when a single column cannot ensure uniqueness.

-------------------------------------------------------------------------------
2ï¸âƒ£0ï¸âƒ£ Create a Sample University Database

Now we design properly like a professional database engineer.

Step 1: Create Database
CREATE DATABASE university_db;
USE university_db;
Step 2: Students Table
CREATE TABLE students (
    student_id INT PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    dob DATE,
    gender VARCHAR(10),
    email VARCHAR(100),
    phone VARCHAR(15)
);
Step 3: Parents Table
CREATE TABLE parents (
    parent_id INT PRIMARY KEY,
    student_id INT,
    father_name VARCHAR(100),
    mother_name VARCHAR(100),
    parent_phone VARCHAR(15),
    FOREIGN KEY(student_id) REFERENCES students(student_id)
);
Step 4: Address Table
CREATE TABLE address (
    address_id INT PRIMARY KEY,
    student_id INT,
    street VARCHAR(100),
    city VARCHAR(50),
    state VARCHAR(50),
    pincode VARCHAR(10),
    FOREIGN KEY(student_id) REFERENCES students(student_id)
);
Step 5: Courses Table
CREATE TABLE courses (
    course_id INT PRIMARY KEY,
    course_name VARCHAR(100),
    credits INT
);
Step 6: Enrollment Table (Many-to-Many)
CREATE TABLE enrollments (
    student_id INT,
    course_id INT,
    semester VARCHAR(10),
    grade VARCHAR(5),
    PRIMARY KEY(student_id, course_id),
    FOREIGN KEY(student_id) REFERENCES students(student_id),
    FOREIGN KEY(course_id) REFERENCES courses(course_id)
);
ğŸ” Database Design Explanation

âœ” Normalized structure
âœ” No redundancy
âœ” Uses primary & foreign keys
âœ” Maintains referential integrity

--------------------------------------------------

ğŸ”¹ 1ï¸âƒ£ What is Indexing? Why is it used?
ğŸ“Œ Definition

An index is a database object that improves the speed of data retrieval operations on a table.

Think of it like:

ğŸ“– Book without index â†’ You scan every page
ğŸ“– Book with index â†’ You directly go to page number

ğŸ§  Without Index (Full Table Scan)
SELECT * FROM citizens WHERE aadhar_no = '123456789012';

If 5 crore records â†’ database checks every row âŒ
Time complexity â‰ˆ O(n)

âœ… With Index
CREATE INDEX idx_aadhar ON citizens(aadhar_no);

Now database uses index structure (usually B-Tree).

Time complexity â‰ˆ O(log n) ğŸ”¥

ğŸ¯ Why Used?

âœ” Faster SELECT queries
âœ” Faster WHERE condition search
âœ” Faster JOIN operations
âœ” Faster ORDER BY

------------------------------------------------------------
ğŸ”· What is an Index in Database?

An index is a data structure (usually B-Tree) that improves data retrieval speed.

Without index â†’ DB scans entire table (Full Table Scan).
With index â†’ DB directly navigates to required rows.

Time complexity improves from:

O(n) â†’ O(log n)

ğŸ”· 1ï¸âƒ£ Clustered Index (In Detail)
ğŸ“Œ Definition

A Clustered Index:

Physically sorts and stores the table data according to the indexed column.

This means:

The table itself is stored in sorted order.

Leaf nodes of index contain the actual table data.

ğŸ“Œ Very Important Rule

âœ” Only ONE clustered index per table

Why?

Because:

Data can only be physically sorted in one way.

ğŸ“Œ Internal Structure

Clustered index is stored as:

ğŸ‘‰ B-Tree

Structure:

Root â†’ Intermediate nodes â†’ Leaf nodes

In clustered index:

Leaf nodes = Actual table rows

So:

Index itself IS the table.

ğŸ“Œ Example
CREATE CLUSTERED INDEX idx_empid 
ON employees(emp_id);

Or:

PRIMARY KEY(emp_id)

In most databases (like SQL Server), Primary Key automatically becomes clustered.

ğŸ“Œ What Happens Internally?

If emp_id values:

1, 2, 3, 4, 5

Data is physically stored in that order on disk.

ğŸ“Œ Performance Characteristics

âœ” Very fast for:

Range queries

BETWEEN queries

Ordered scans

Example:

SELECT * FROM employees 
WHERE emp_id BETWEEN 1000 AND 2000;

Since data is sorted physically:

DB reads contiguous pages â†’ very efficient.

ğŸ“Œ Insert Performance Impact

If table is clustered on emp_id:

Inserting new rows in middle:

May cause page splits â†’ slightly slower inserts.

ğŸ”· 2ï¸âƒ£ Non-Clustered Index (In Detail)
ğŸ“Œ Definition

A Non-Clustered Index:

Does NOT change physical order of table.

Instead:

It creates a separate structure.

Leaf nodes contain pointers to actual data rows.

ğŸ“Œ Internal Structure

Non-clustered index also uses B-Tree.

But:

Leaf nodes contain:

ğŸ‘‰ Indexed column value
ğŸ‘‰ Pointer (Row ID or Clustered Key)

Not actual data.

ğŸ“Œ Example
CREATE INDEX idx_name 
ON employees(name);

Now:

Table remains physically ordered by emp_id.

But index on name is stored separately.

ğŸ“Œ How It Works Internally

Suppose:

name = 'Ram'

Index stores:

Ram â†’ Pointer â†’ Row location

So DB:

Searches index (fast)

Follows pointer

Fetches actual data row

ğŸ“Œ Performance Characteristics

âœ” Very fast for:

Exact search

Lookup by specific value

Example:

SELECT * FROM employees 
WHERE name = 'Ram';

But:

Range queries less efficient compared to clustered.

ğŸ”· Detailed Comparison
Feature	Clustered Index	Non-Clustered Index
Physical order	Yes	No
Number allowed	One	Multiple
Leaf nodes	Actual data	Pointers
Storage	Table itself	Separate
Range queries	Very fast	Moderate
Insert speed	Slower (due to sorting)	Faster
Best for	Primary key, range queries	Search queries

----------------------------------------------------------------

ğŸ”· What is a Composite Index?
ğŸ“Œ Definition

A Composite Index (also called multi-column index) is:

An index created on two or more columns of a table.

ğŸ”¹ Syntax
CREATE INDEX idx_name_city 
ON citizens(name, city);

This creates an index on:

name

city

The order matters. Very important.

ğŸ”· Why Do We Need Composite Index?

Letâ€™s assume this table:

ğŸ“Œ citizens (50 million rows)
citizen_id	name	city	age
1	Ravi	Hyderabad	30
2	Ravi	Chennai	25
3	Arun	Hyderabad	40
4	Kiran	Delhi	28
ğŸ”´ Problem Without Composite Index

Query:

SELECT * 
FROM citizens
WHERE name = 'Ravi' 
AND city = 'Hyderabad';

Without composite index:

DB may scan many rows.

Even if index on name exists,
DB still needs to check city manually.

ğŸ”· With Composite Index
CREATE INDEX idx_name_city
ON citizens(name, city);

Now DB creates a B-Tree sorted like this:

(name, city)

Arun, Hyderabad
Kiran, Delhi
Ravi, Chennai
Ravi, Hyderabad

Now query becomes fast ğŸ”¥

Because:

DB can directly navigate tree using:

'name' â†’ 'Ravi'
Then immediately filter on 'city'

ğŸ”· Very Important Rule: Column Order Matters

This is called:

ğŸ”¹ Leftmost Prefix Rule

If index is created as:

(name, city)

It works efficiently for:

âœ” WHERE name = 'Ravi'
âœ” WHERE name = 'Ravi' AND city = 'Hyderabad'

âŒ But NOT Efficient For:
WHERE city = 'Hyderabad';

Because city is second column.

Index is sorted first by name.

So DB cannot efficiently start search from city.

ğŸ”· Example To Understand Order

If index is:

CREATE INDEX idx_city_name 
ON citizens(city, name);

Now it works efficiently for:

âœ” WHERE city = 'Hyderabad'
âœ” WHERE city = 'Hyderabad' AND name='Ravi'

ğŸ”· Performance Comparison

Without composite index:

O(n) scan

With composite index:

O(log n) search

Huge improvement for large databases.

ğŸ”· Real CGG Example

Citizen portal query:

SELECT citizen_id 
FROM citizens
WHERE district = 'Hyderabad'
AND status = 'Active';

Best composite index:

CREATE INDEX idx_district_status
ON citizens(district, status);
ğŸ”· When to Use Composite Index?

âœ” Columns frequently used together in WHERE
âœ” Columns used in JOIN + WHERE
âœ” Columns used in filtering + sorting

ğŸ”· Composite Index with ORDER BY

Example:

SELECT * 
FROM citizens
WHERE name = 'Ravi'
ORDER BY city;

Index on:

(name, city)

Helps in both filtering AND sorting.

ğŸ”· What Happens Internally?

Composite index stores:

Column1 â†’ Column2 â†’ Row pointer

Example B-Tree:

Root
â”œâ”€â”€ Arun
â”‚ â””â”€â”€ Hyderabad
â”œâ”€â”€ Ravi
â”‚ â”œâ”€â”€ Chennai
â”‚ â””â”€â”€ Hyderabad
â””â”€â”€ Kiran
â””â”€â”€ Delhi

ğŸ”· Important Mistake Many Developers Do

Creating separate indexes:

CREATE INDEX idx_name ON citizens(name);
CREATE INDEX idx_city ON citizens(city);

This is NOT same as composite index.

DB might still scan multiple rows.

Composite index is better when conditions use both columns.

ğŸ”· Advanced Concept: Covering Composite Index

If query:

SELECT name, city 
FROM citizens
WHERE name = 'Ravi'
AND city = 'Hyderabad';

Index:

CREATE INDEX idx_cover
ON citizens(name, city);

DB may not even touch table.

This is called:

ğŸ‘‰ Index Only Scan (Very Fast)

ğŸ”· Interview Question Example

Q: When does composite index not help?

Answer:

If query uses only second column

If order of columns mismatched

If function used on indexed column

Example âŒ:

WHERE LOWER(name) = 'ravi'

Index not used.

ğŸ”· Summary Table
Feature	Composite Index
Based on	Multiple columns
Order matters	Yes
Helps	Multi-condition queries
Uses	Leftmost prefix rule
Improves	Search + Join + Sorting
ğŸ¯ Interview Ready Answer

A Composite Index is an index created on multiple columns. It improves performance when queries filter on more than one column. The order of columns is important because of the leftmost prefix rule, meaning the index works efficiently when queries use the first column alone or in combination with subsequent columns, but not efficiently when only later columns are used.

-------------------------------------------------------------------------

ğŸ”¹ 4ï¸âƒ£ How Does Indexing Improve Performance?
ğŸ” Mechanism

Most databases use B-Tree.

Without index:

Full scan

O(n)

With index:

Binary search-like structure

O(log n)

Example:

5 crore records:

Without index â†’ 5 crore comparisons
With index â†’ maybe 25 comparisons ğŸ”¥

Also improves:

âœ” JOIN performance
âœ” GROUP BY
âœ” ORDER BY
âœ” Foreign key lookups

ğŸ”¹ 5ï¸âƒ£ Disadvantages of Indexing

Important question âš 

âŒ 1. Increases Storage

Indexes consume extra disk space.

âŒ 2. Slower INSERT / UPDATE / DELETE

Every time row changes â†’ index must update.

Example:

INSERT INTO citizens VALUES(...);

Database must:

Insert row

Update index

âŒ 3. Too Many Indexes = Slower System

More indexes = more maintenance overhead.

ğŸ¯ CGG Scenario

In land record system:

Too many indexes â†’ slows down bulk updates

Balance is required

------------------------------------------------------------------------------------------

ğŸ”· What is a Covering Index?
ğŸ“Œ Definition

A Covering Index is:

An index that contains all the columns required to satisfy a query â€” both in the WHERE clause and in the SELECT clause.

Because of that:

ğŸ‘‰ The database does NOT need to access the main table.
ğŸ‘‰ Everything is retrieved directly from the index.

This is called:

ğŸ”¥ Index Only Scan
ğŸ”· Why Is It So Fast?

Normally, when you query using an index:

DB searches index â†’ finds matching row pointer.

Then DB goes to main table â†’ fetches remaining columns.

That second step is called:

ğŸ‘‰ Table Lookup (or Key Lookup)

Table lookup is expensive (extra disk I/O).

Covering index eliminates this step.

ğŸ”· Example Scenario

Table: citizens (50 million rows)

citizen_id	name	city	aadhar_no	mobile_no
ğŸ”´ Normal Query
SELECT name, city 
FROM citizens 
WHERE aadhar_no = '123';
ğŸ”¹ Case 1: Only Index on aadhar_no
CREATE INDEX idx_aadhar 
ON citizens(aadhar_no);
What happens?

Step 1: DB finds aadhar_no in index.
Step 2: DB fetches row from main table to get name and city.

Two operations required.

ğŸ”¹ Case 2: Covering Index
CREATE INDEX idx_cover 
ON citizens(aadhar_no, name, city);

Now:

The index stores:

aadhar_no | name | city | pointer

When query runs:

SELECT name, city 
FROM citizens 
WHERE aadhar_no = '123';

DB finds data directly inside index.

No table lookup required.

Much faster ğŸš€

ğŸ”· Internal Working (Important Concept)

Non-covering index:

Index â†’ Pointer â†’ Table â†’ Fetch columns

Covering index:

Index â†’ Done

Less disk I/O
Less memory usage
Better cache efficiency

ğŸ”· Visual Example

Imagine index as small sorted book.

Without covering index:

You look at index â†’ get page number â†’ open large book â†’ read data.

With covering index:

Everything already written in index book â†’ no need for large book.

ğŸ”· When Does Covering Index Help Most?

âœ” Large tables (millions of rows)
âœ” Frequently executed queries
âœ” Read-heavy applications
âœ” API search endpoints

---------------------------------------------------------------

ğŸ”¹ 7ï¸âƒ£ What is Query Optimization?
ğŸ“Œ Definition

Query optimization is the process of improving query performance.

Done by:

Rewriting query

Adding indexes

Reducing joins

Removing unnecessary columns

Avoiding subqueries

Example (Bad Query)
SELECT * FROM employees 
WHERE YEAR(joining_date) = 2023;

Problem:
Index cannot be used.

Better:

SELECT * FROM employees
WHERE joining_date 
BETWEEN '2023-01-01' AND '2023-12-31';

--------------------------------------------------------------

ğŸ”· What is an Execution Plan?
ğŸ“Œ Definition

An Execution Plan is:

A step-by-step strategy generated by the database optimizer that shows how the database will execute a SQL query.

It answers:

ğŸ‘‰ How will the database retrieve data?
ğŸ‘‰ Which indexes will be used?
ğŸ‘‰ Which tables will be scanned?
ğŸ‘‰ Which join method will be used?
ğŸ‘‰ What is the estimated cost?

ğŸ”· Why Do We Need Execution Plan?

Because:

Query may work correctly

But may be slow

Or scanning millions of rows unnecessarily

Execution plan helps in:

âœ” Performance tuning
âœ” Debugging slow queries
âœ” Index optimization
âœ” Understanding join behavior

ğŸ”· How to See Execution Plan?
ğŸ”¹ In MySQL
EXPLAIN SELECT * FROM employees WHERE salary > 50000;
ğŸ”¹ In PostgreSQL
EXPLAIN ANALYZE SELECT * FROM employees WHERE salary > 50000;
ğŸ”· Example 1: Without Index

Table: employees (10 lakh rows)

SELECT * FROM employees WHERE salary = 60000;
ğŸ”¹ Execution Plan (Without Index)
type: ALL
rows: 1000000
key: NULL
Extra: Using where
ğŸ” Meaning:

type = ALL â†’ Full table scan âŒ

rows = 1,000,000 â†’ All rows scanned

key = NULL â†’ No index used

Very slow ğŸš¨

ğŸ”· Example 2: With Index

Create index:

CREATE INDEX idx_salary ON employees(salary);

Now run:

EXPLAIN SELECT * FROM employees WHERE salary = 60000;
ğŸ”¹ Execution Plan (With Index)
type: ref
rows: 10
key: idx_salary
Extra: Using index condition
ğŸ” Meaning:

type = ref â†’ Index lookup âœ”

rows = 10 â†’ Only few rows scanned

key = idx_salary â†’ Index used âœ”

Much faster ğŸ”¥

ğŸ”· Important Components of Execution Plan
1ï¸âƒ£ Type (Access Type)

Shows how rows are accessed.

Type	Meaning	Performance
system	Single row	Best
const	Primary key lookup	Very fast
eq_ref	Unique index join	Excellent
ref	Non-unique index lookup	Good
range	Range scan	Good
index	Full index scan	Moderate
ALL	Full table scan	Slow âŒ

---------------------------------------------------------------------

ğŸ”¹ 9ï¸âƒ£ How Do You Analyze Slow Queries?
Step-by-step approach:

1ï¸âƒ£ Use EXPLAIN
2ï¸âƒ£ Check full table scans
3ï¸âƒ£ Check missing indexes
4ï¸âƒ£ Check join conditions
5ï¸âƒ£ Avoid SELECT *
6ï¸âƒ£ Check data types
7ï¸âƒ£ Check subqueries
8ï¸âƒ£ Check network delay

Example:
EXPLAIN SELECT * 
FROM citizens 
WHERE district = 'Hyderabad';

If output shows:

type = ALL
â†’ Full table scan âŒ

Then add index:

CREATE INDEX idx_district ON citizens(district);

------------------------------------------------------------------------------------

ğŸ”¹ Normalization & Design



ğŸ”¹ 1ï¸âƒ£ What is Normalization?
ğŸ“Œ Definition

Normalization is the process of organizing data in a database to:

Reduce redundancy

Avoid anomalies

Improve data integrity

Maintain consistency

ğŸ¯ Why Important for CGG?

In government systems like:

Land records

Pension systems

Scholarship portals

Citizen databases

Duplicate data can cause:

Wrong benefits

Wrong payments

Legal problems

ğŸ§  Simple Idea

Bad Design âŒ

StudentID	Name	Course	Instructor
1	Ravi	DBMS	Kumar
1	Ravi	OS	Sharma

Here:

Ravi repeated

Data redundancy

Normalization splits this properly.

ğŸ”¹ 2ï¸âƒ£ First Normal Form (1NF)
ğŸ“Œ Rule

1NF says:

No repeating groups

No multi-valued attributes

Each column must contain atomic values

âŒ Not in 1NF
StudentID	Name	Courses
1	Ravi	DBMS, OS

Courses has multiple values âŒ

âœ… Convert to 1NF
StudentID	Name	Course
1	Ravi	DBMS
1	Ravi	OS

Now each cell has single value âœ”

ğŸ”¹ 3ï¸âƒ£ Second Normal Form (2NF)
ğŸ“Œ Rule

Must satisfy:
1ï¸âƒ£ Already in 1NF
2ï¸âƒ£ No partial dependency

ğŸ“Œ What is Partial Dependency?

When a non-key column depends on part of composite key.

Example

Enrollment table:

StudentID	CourseID	StudentName	CourseName

Primary Key = (StudentID, CourseID)

But:

StudentName depends only on StudentID âŒ

CourseName depends only on CourseID âŒ

âŒ Problem â†’ Partial dependency
âœ… Convert to 2NF

Split into:

Students Table:

| StudentID | StudentName |

Courses Table:

| CourseID | CourseName |

Enrollments Table:

| StudentID | CourseID |

Now no partial dependency âœ”

ğŸ”¹ 4ï¸âƒ£ Third Normal Form (3NF)
ğŸ“Œ Rule

Must satisfy:

1ï¸âƒ£ In 2NF
2ï¸âƒ£ No transitive dependency

ğŸ“Œ What is Transitive Dependency?

When non-key column depends on another non-key column.

âŒ Example

| StudentID | Name | DeptID | DeptName |

Primary Key: StudentID

But:

DeptName depends on DeptID

DeptID depends on StudentID

So DeptName depends indirectly on StudentID âŒ

âœ… Convert to 3NF

Students:

| StudentID | Name | DeptID |

Departments:

| DeptID | DeptName |

Now transitive dependency removed âœ”

ğŸ”¹ 5ï¸âƒ£ What is BCNF?
ğŸ“Œ BCNF (Boyce-Codd Normal Form)

Stronger version of 3NF.

Rule:

For every functional dependency A â†’ B,
A must be a super key.

When BCNF is Needed?

If multiple candidate keys exist.

Example:

| Professor | Subject | Room |

If:
Professor â†’ Subject
Subject â†’ Room

There is overlapping dependency â†’ violates BCNF.

Split table appropriately.

ğŸ”¹ 6ï¸âƒ£ What is Denormalization?
ğŸ“Œ Definition

Denormalization is combining tables to:

Improve performance

Reduce joins

Speed up read operations

Example

Instead of joining:

Students + Department

We store department name directly in student table.

ğŸ¯ When Used?

Data warehouse

Reporting system

Read-heavy systems

âš  Tradeoff

âœ” Faster reads
âŒ More redundancy

ğŸ”¹ 7ï¸âƒ£ What are Anomalies?
ğŸ”´ 1. Insert Anomaly

Cannot insert data without other data.

Example:

Cannot insert new course unless student enrolls.

ğŸ”´ 2. Update Anomaly

Same data stored multiple times.

If department name changes â†’ update everywhere âŒ

ğŸ”´ 3. Delete Anomaly

Deleting one record removes important info.

If last student leaves course â†’ course info lost âŒ

Normalization removes these.

ğŸ”¹ 8ï¸âƒ£ What is Functional Dependency?
ğŸ“Œ Definition

If A â†’ B
Means B depends on A.

Example:

StudentID â†’ StudentName

One student ID gives exactly one name.

ğŸ¯ Important for normalization.
ğŸ”¹ 9ï¸âƒ£ What is Candidate Key?
ğŸ“Œ Definition

A candidate key is:

A minimal set of columns that uniquely identify a row.

There can be multiple candidate keys.

Example:

| StudentID | Email | Aadhaar |

Each can uniquely identify student.

All are candidate keys.

ğŸ”¹ ğŸ”Ÿ What is Super Key?
ğŸ“Œ Definition

Super key is:

Any set of columns that uniquely identify rows.

Includes unnecessary columns.

Example:

StudentID alone â†’ Candidate key
StudentID + Name â†’ Super key

But not minimal.

ğŸ”¹ 1ï¸âƒ£1ï¸âƒ£ What is Surrogate Key?
ğŸ“Œ Definition

Artificial key created by system.

Example:

AUTO_INCREMENT ID

CREATE TABLE students (
   id INT AUTO_INCREMENT PRIMARY KEY,
   name VARCHAR(100)
);
Why Used?

âœ” Simpler joins
âœ” Stable key
âœ” Better indexing

ğŸ”¹ 1ï¸âƒ£2ï¸âƒ£ What is Referential Integrity?
ğŸ“Œ Definition

Ensures:

Foreign key value must match primary key in parent table.

Example:

Students Table:

| student_id |

Enrollments Table:

| student_id (FK) |

Constraint:

FOREIGN KEY(student_id) REFERENCES students(student_id)
What Happens?

If student doesnâ€™t exist â†’ cannot insert enrollment âŒ

ğŸ¯ CGG Example

In government:

Citizen table
Application table

Application must reference valid citizen.

Referential integrity ensures data validity.
-------------------------------------------------------------------------------------------------------------------

ğŸ”¹ Transactions & Concurrency

ğŸ”· 1ï¸âƒ£ What is a Transaction?
ğŸ“Œ Interview Definition

A transaction is:

A sequence of one or more SQL operations executed as a single logical unit of work, which either fully completes or fully fails.

ğŸ” Why Do We Need Transactions?

Because real-world operations involve multiple steps.

ğŸ’³ Example: Bank Money Transfer

Transfer â‚¹5000 from Account A to Account B:

START TRANSACTION;

UPDATE accounts SET balance = balance - 5000 WHERE acc_id='A';
UPDATE accounts SET balance = balance + 5000 WHERE acc_id='B';

COMMIT;

If system crashes after first update:

Without transaction â†’ money deducted but not credited âŒ
With transaction â†’ rollback ensures consistency âœ”

ğŸ”¹ Important Commands
START TRANSACTION;
COMMIT;
ROLLBACK;
ğŸ”· 2ï¸âƒ£ ACID Properties (Very Important for Interview)

Transactions follow ACID principles.

ğŸ”¹ A â€” Atomicity (All or Nothing)

If one operation fails â†’ whole transaction fails.

Example:

In bank transfer, if credit step fails â†’ debit should also revert.

Ensured by: ROLLBACK.

ğŸ”¹ C â€” Consistency

Database moves from one valid state to another valid state.

Example:

Total money before and after transfer must remain same.

Integrity constraints help ensure consistency:

Primary Key

Foreign Key

Unique

Check constraints

ğŸ”¹ I â€” Isolation

Transactions should not interfere with each other.

Example:

Two users booking same train seat at same time.

Isolation ensures only one booking succeeds.

ğŸ”¹ D â€” Durability

Once committed, changes are permanently saved.

Even if:

Power failure

System crash

Handled using:

Write-ahead logs

Redo logs

Database recovery mechanisms

ğŸ”· 3ï¸âƒ£ What is Concurrency?

Concurrency means:

Multiple transactions executing at the same time.

Example:

1000 users applying for scholarship simultaneously.

Database must handle:

âœ” Accuracy
âœ” Performance
âœ” Data integrity

-------------------------------------------------------------------

ğŸ”· What is Isolation Level?
ğŸ“Œ Definition

Isolation level defines:

How much one transaction is allowed to see the uncommitted changes of another transaction.

It controls:

Data visibility

Concurrency behavior

Locking behavior

Consistency vs performance tradeoff

ğŸ”¥ Why Isolation Is Needed?

Imagine:

Citizen A paying property tax
Citizen B viewing tax status

If payment is in progress and not completed,
Should B see it or not?

Isolation level decides that.

ğŸ§  Example Scenario

Two transactions running:

Transaction 1 (T1)
BEGIN;
UPDATE accounts SET balance = balance - 1000 WHERE id = 1;

Not committed yet âŒ

Transaction 2 (T2)
SELECT balance FROM accounts WHERE id = 1;

Should T2 see deducted balance or old balance?

Isolation level controls this.

ğŸ”· Types of Isolation Levels

There are 4 standard isolation levels (SQL standard).

1ï¸âƒ£ Read Uncommitted (Lowest Isolation)
ğŸ“Œ Rule

Can read data even if not committed.

â— Problem: Dirty Read

T1 updates salary but doesn't commit.
T2 reads that value.

If T1 rolls back â†’ T2 read wrong data.

Dirty Read Example

T1:

UPDATE employees SET salary = 100000 WHERE id = 1;

(Not committed)

T2:

SELECT salary FROM employees WHERE id = 1;

Sees 100000 âŒ

T1:

ROLLBACK;

Now salary back to old value.

T2 read incorrect data âŒ

ğŸŸ¡ Performance: Fast
ğŸ”´ Risk: High

Not suitable for banking/government.

2ï¸âƒ£ Read Committed (Default in many DBs)
ğŸ“Œ Rule

Can only read committed data.

Prevents dirty reads.

Behavior

If T1 not committed â†’ T2 cannot see that change.

ğŸ”´ Problem: Non-Repeatable Read

T2 reads value twice and gets different results.

Example:

T2:

SELECT salary FROM employees WHERE id = 1;

Gets 50000.

T1 updates and commits:

UPDATE employees SET salary = 60000 WHERE id = 1;
COMMIT;

T2 reads again â†’ 60000.

Value changed during transaction âŒ

ğŸŸ¢ Safe for most systems
ğŸŸ¡ Medium performance
3ï¸âƒ£ Repeatable Read
ğŸ“Œ Rule

If a transaction reads data,
no other transaction can modify it until current transaction ends.

Prevents:

âœ” Dirty read
âœ” Non-repeatable read

ğŸ”´ But allows Phantom Read
What is Phantom Read?

T2 reads all rows where salary > 50000.

Meanwhile T1 inserts a new employee with salary 70000 and commits.

If T2 runs query again â†’ new row appears.

That new row is phantom row.

ğŸŸ¢ Very safe
ğŸŸ¡ More locking
ğŸŸ¡ Slightly slower

Used in financial systems.

4ï¸âƒ£ Serializable (Highest Isolation)
ğŸ“Œ Rule

Transactions behave as if running one after another (no overlap).

Prevents:

âœ” Dirty reads
âœ” Non-repeatable reads
âœ” Phantom reads

But:

ğŸ”´ Very slow
ğŸ”´ Heavy locking
ğŸ”´ Can reduce concurrency

------------------------------------------------------------------------
ğŸ”· 6ï¸âƒ£ What is Dirty Read?

Dirty read occurs when:

A transaction reads uncommitted data from another transaction.

ğŸ” Example

Transaction T1:

START TRANSACTION;
UPDATE accounts SET balance=9000 WHERE acc_id='A';
-- not committed yet

Transaction T2:

SELECT balance FROM accounts WHERE acc_id='A';
-- Reads 9000

Then T1 rolls back.

Now balance was never actually 9000.

T2 read wrong data âŒ

This is Dirty Read.

Prevented by: Read Committed isolation.

------------------------------------------------

ğŸ”· What is Non-Repeatable Read?
ğŸ“Œ Definition

A Non-Repeatable Read occurs when:

A transaction reads the same row twice and gets different values because another transaction modified and committed that row in between.

So the data is not repeatable inside the same transaction.

ğŸ§  Why It Happens?

It happens when:

Isolation level is Read Committed

Database allows other transactions to modify rows

First transaction does not lock the row for full duration

ğŸ”¥ Step-by-Step Example

Assume accounts table:

acc_id	balance
A	10000
ğŸ‘¤ Transaction 1 (T1)
START TRANSACTION;
SELECT balance FROM accounts WHERE acc_id='A';

Output:

10000

T1 expects this value to remain same inside transaction.

ğŸ‘¤ Transaction 2 (T2)
UPDATE accounts SET balance=12000 WHERE acc_id='A';
COMMIT;

Now balance updated permanently to 12000.

ğŸ‘¤ Transaction 1 (T1 again)
SELECT balance FROM accounts WHERE acc_id='A';

Output:

12000

âš  Value changed inside same transaction.

This is Non-Repeatable Read.

ğŸ“Š Visualization
T1: Reads balance â†’ 10000
T2: Updates balance â†’ 12000 (committed)
T1: Reads again â†’ 12000 âŒ

The row changed while T1 was still running.

ğŸ”´ Why Is This Dangerous?

In financial systems:

Example:
T1 calculates tax or interest based on first read.
If value changes mid-transaction â†’ wrong calculation.

Example in CGG:

Officer verifying land payment:

First read: Payment pending

Second read: Payment completed

Result inconsistency

Could cause incorrect approvals.

-------------------------------------------------------------

ğŸ”· What is Phantom Read?
ğŸ“Œ Definition

A Phantom Read occurs when:

A transaction re-executes a query and finds additional rows (or missing rows) because another transaction inserted or deleted rows and committed them in between.

So the row set changes, not just column values.

ğŸ§  Simple Meaning

Non-Repeatable Read â†’ Same row, value changed

Phantom Read â†’ New rows appeared (or disappeared)

ğŸ”¥ Example in Detail

Assume employees table:

emp_id	name	salary
1	Arun	55000
2	Sita	70000
3	John	40000
4	Meena	65000
5	Raj	52000
ğŸ‘¤ Transaction 1 (T1)
START TRANSACTION;
SELECT * FROM employees WHERE salary > 50000;

Result:

emp_id	name	salary
1	Arun	55000
2	Sita	70000
4	Meena	65000
5	Raj	52000

ğŸ‘‰ Suppose 4 rows returned.

T1 assumes this is the full result set.

ğŸ‘¤ Transaction 2 (T2)
INSERT INTO employees VALUES (6,'Ravi',60000);
COMMIT;

Now Ravi qualifies for salary > 50000.

ğŸ‘¤ Transaction 1 (T1 again)
SELECT * FROM employees WHERE salary > 50000;

Result:

Now 5 rows appear.
New row (Ravi) appeared.

âš  A new â€œphantomâ€ row appeared inside same transaction.

That is Phantom Read.

ğŸ“Š Visual Timeline
T1 â†’ Read rows (4 rows)

T2 â†’ Insert new matching row â†’ COMMIT

T1 â†’ Reads again â†’ Now 5 rows âŒ

Row set changed.

ğŸ”· Why Does Phantom Read Occur?

Because:

Isolation level is Read Committed or Repeatable Read

Database locks existing rows

But does not lock the range of rows matching the condition

So new rows can enter the result set.
---------------------------------------------------------------------------------

ğŸ”· 9ï¸âƒ£ What is Locking?
ğŸ“Œ Definition

Locking is a mechanism used by the database to:

Control concurrent access to data so that multiple transactions do not corrupt or modify the same data simultaneously.

It ensures:

Data consistency

Isolation (ACID property)

Prevention of dirty reads

Prevention of lost updates

ğŸ”¥ Why Locking Is Needed?

Imagine:

Two officers updating same land record:

T1:

UPDATE land SET owner='Ravi' WHERE plot_id=101;

T2:

UPDATE land SET owner='Sita' WHERE plot_id=101;

If both execute at same time without locking:

Final owner may be unpredictable âŒ
This is called Lost Update problem.

Locking prevents this.

ğŸ”· Types of Locks
1ï¸âƒ£ Shared Lock (S Lock)
ğŸ“Œ Purpose

Used for reading data.

ğŸ”¹ Characteristics

âœ” Multiple transactions can acquire shared lock on same data
âŒ Cannot modify while shared lock exists

ğŸ§  Example

T1:

SELECT * FROM accounts WHERE acc_id='A';

Database applies Shared Lock on that row.

T2:

SELECT * FROM accounts WHERE acc_id='A';

Allowed âœ” (multiple reads allowed)

But:

T3:

UPDATE accounts SET balance=20000 WHERE acc_id='A';

Blocked âŒ until S lock released.

ğŸ”· Use Case

Government portal:
Many users viewing same property record.

Reading allowed concurrently.

2ï¸âƒ£ Exclusive Lock (X Lock)
ğŸ“Œ Purpose

Used for modifying data (INSERT, UPDATE, DELETE).

ğŸ”¹ Characteristics

âœ” Only one transaction allowed
âŒ No other read or write allowed

ğŸ§  Example

T1:

UPDATE accounts SET balance=15000 WHERE acc_id='A';

X Lock applied.

Now:

T2:

SELECT balance FROM accounts WHERE acc_id='A';

Blocked âŒ

T3:

UPDATE accounts SET balance=18000 WHERE acc_id='A';

Blocked âŒ

Only T1 can proceed.

ğŸ”· Important Rule

X Lock is stronger than S Lock.

Compatibility:

Lock Type	Shared	Exclusive
Shared	âœ” Allowed	âŒ Not allowed
Exclusive	âŒ Not allowed	âŒ Not allowed
ğŸ”· Lock Granularity

Granularity means:

How much data is locked.

Finer granularity â†’ Better concurrency.

1ï¸âƒ£ Row-Level Lock

Locks only specific row.

Best for high concurrency.

Example
UPDATE employees SET salary=70000 WHERE emp_id=10;

Only row with emp_id=10 locked.

Other rows free.

âœ” More concurrent access
âœ” Better performance

Used in OLTP systems like CGG.

2ï¸âƒ£ Page-Level Lock

Locks a page (group of rows stored together).

Less concurrency.

If 100 rows in page:
Updating 1 row locks all 100 rows.

Used sometimes internally by database.

3ï¸âƒ£ Table-Level Lock

Locks entire table.

Example
LOCK TABLE employees WRITE;

Now:

âŒ No one can read or write
until lock released.

Used rarely in high-concurrency systems.

ğŸ”· Granularity Comparison
Lock Level	Concurrency	Performance
Row-Level	High	Best
Page-Level	Medium	Moderate
Table-Level	Low	Low (heavy lock)
ğŸ”· How Locking Works Internally

Most databases follow:

Two-Phase Locking (2PL):

1ï¸âƒ£ Growing Phase â†’ Acquire locks
2ï¸âƒ£ Shrinking Phase â†’ Release locks

Ensures serializable behavior.

---------------------------------------------------------------------

ğŸ”· ğŸ”Ÿ What is Deadlock?
ğŸ“Œ Definition

A Deadlock occurs when:

Two or more transactions are waiting for each other to release locks, and none of them can proceed.

It creates a circular wait condition.

ğŸ”¥ Basic Example

Assume table accounts

ğŸ‘¤ Transaction 1 (T1)
UPDATE accounts SET balance = balance - 1000 WHERE acc_id = 'A';

Locks Row A (Exclusive Lock)

Now wants to update Row B:

UPDATE accounts SET balance = balance + 1000 WHERE acc_id = 'B';

But Row B is locked by T2.

ğŸ‘¤ Transaction 2 (T2)
UPDATE accounts SET balance = balance - 500 WHERE acc_id = 'B';

Locks Row B.

Now wants Row A:

UPDATE accounts SET balance = balance + 500 WHERE acc_id = 'A';

But Row A is locked by T1.

ğŸ“Š Deadlock Situation
T1 holds Row A â†’ waiting for Row B
T2 holds Row B â†’ waiting for Row A

Neither can proceed âŒ
Both waiting forever.

That is Deadlock.

ğŸ”· Why Deadlock Happens?

Deadlock happens when these four conditions occur together:

1ï¸âƒ£ Mutual Exclusion (resource cannot be shared)
2ï¸âƒ£ Hold and Wait (transaction holds one lock and waits for another)
3ï¸âƒ£ No Preemption (locks cannot be forcibly taken)
4ï¸âƒ£ Circular Wait (cycle exists)

If all 4 are present â†’ Deadlock possible.

ğŸ”· Real CGG Scenario

Imagine:

Officer 1:
Updating land record in District A and then District B.

Officer 2:
Updating District B and then District A.

If order not consistent â†’ Deadlock.
--------------------------------------------------------------------------







